#panel.grid = element_blank(),
plot.margin=unit(c(0,4,2,3),"pt"),
axis.line.x = element_line(size=0.4),
panel.border = element_blank()
)
pdf(file="AM2-062_chr5.pdf",width=2.5/2.54,height=4/2.54)
ggarrange(P_MIS1,P_Mel1,P_Mel2,P_Met2_v3,ncol=1,nrow=4,heights=c(1.1,1,1,1.6),align="v")
dev.off()
setwd("/Users/mengwang/Documents/GitHub/Genetic-evolution-acral-melanoma/Figure_scripts")
library(ggplot2)
library(ggtext)
library(dplyr)
library(reshape2)
library(gridExtra)
library(ggpubr)
library(gdata)
calc_distance = function(x){
mutDis = c()
for (i in 1:nrow(x)){
dis = NA
if(i==1){
if(x$Chr[2]==x$Chr[1]) dis = c(dis,x$Start[2]-x$Start[1])
}
else if(i==nrow(x)){
if(x$Chr[i]==x$Chr[i-1]) dis = c(dis,x$Start[i]-x$Start[i-1])
}
else{
if ((x$Chr[i-1] == x$Chr[i])){
dis = c(dis,x$Start[i]-x$Start[i-1])
}
if( (x$Chr[i+1] == x$Chr[i])){
dis = c(dis,x$Start[i+1]-x$Start[i])
}
}
mutDis = c(mutDis,min(dis,na.rm=T))
}
mutDis = ifelse(mutDis == Inf,100000000,mutDis)
x$mutDis = mutDis
return(x)
}
chrlen = read.table("./extdata/f1a_chrLength_hg19.txt",header=T)
InvA_cnr = read.table("./extdata/f4_Case062_InvA.call.cnr",header=T,sep="\t")
InvA_cnr$aStart = chrlen[match(InvA_cnr$chromosome,chrlen$Chr),]$aStart + InvA_cnr$start -1
InvA_cnr$aEnd = chrlen[match(InvA_cnr$chromosome,chrlen$Chr),]$aStart + InvA_cnr$end -1
InvA_cns = read.table("./extdata/f4_Case062_InvA.call.cns",header=T,sep="\t")
InvA_cns$aStart = chrlen[match(InvA_cns$chromosome,chrlen$Chr),]$aStart + InvA_cns$start -1
InvA_cns$aEnd = chrlen[match(InvA_cns$chromosome,chrlen$Chr),]$aStart + InvA_cns$end -1
InvA_cnr$log2 = ifelse(InvA_cnr$log2< -1,(InvA_cnr$log2-8)/9,InvA_cnr$log2)
InvA_cns$log2 = ifelse(InvA_cns$log2< -1,(InvA_cns$log2-8)/9,InvA_cns$log2)
InvA_cns = filter(InvA_cns,(end-start)>10000)
index = c(sample(1:round(nrow(InvA_cnr)),round(nrow(InvA_cnr)/20)),(1:nrow(InvA_cnr))[grepl("CDKN2A|CDKN2B|YAP1|RAF1",InvA_cnr[1:nrow(InvA_cnr),]$gene)])
P_InvA_cns = ggplot(InvA_cnr[index,])+
geom_vline(data=chrlen[1:22,],aes(xintercept=aEnd),linetype="dashed",color="darkgrey",size=0.15)+
geom_point(aes((aStart+aEnd)/2,log2),size=0.01,color="gray")+
geom_hline(data=chrlen[1:22,],aes(yintercept= -0.008695949),color="gray25",size=0.3)+
geom_segment(aes(x=aStart,xend=aEnd,y=log2,yend=log2),color="purple2",size=0.55,lineend="round",data=InvA_cns)+
scale_y_continuous(limits=c(-2,6.5),breaks=c(-2,0,3,6),labels=c(0,2,16,128))+
scale_x_continuous(limits=c(0,3036290862),expand = c(0.01,0.01),breaks=chrlen$midPoint[c(1:18,20,22,23)],labels=c(1:18,20,22,"X"))+
ylab("CN")+  #annotate("text",x=52000000,y=6,label="PRI",angle=270,size=3.5)+
theme_bw()+
theme(panel.grid = element_blank(),
axis.text.x = element_blank(),
#axis.text.x = element_text(size=unit(5,"pt"),margin=unit(c(-1,0,0,0),"pt")),
#axis.text.x = element_text(size=unit(6,"pt"),margin=unit(c(0,0,0,0),"pt")),
axis.text.y = element_text(size=unit(5,"pt")),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks.x = element_blank(),
plot.margin=unit(c(2,2,0,2),"pt")
)
##################
InvB_cnr = read.table("./extdata/f4_Case062_InvB.call.cnr",header=T,sep="\t")
InvB_cnr$aStart = chrlen[match(InvB_cnr$chromosome,chrlen$Chr),]$aStart + InvB_cnr$start -1
InvB_cnr$aEnd = chrlen[match(InvB_cnr$chromosome,chrlen$Chr),]$aStart + InvB_cnr$end -1
InvB_cns = read.table("./extdata/f4_Case062_InvB.call.cns",header=T,sep="\t")
InvB_cns$aStart = chrlen[match(InvB_cns$chromosome,chrlen$Chr),]$aStart + InvB_cns$start -1
InvB_cns$aEnd = chrlen[match(InvB_cns$chromosome,chrlen$Chr),]$aStart + InvB_cns$end -1
InvB_cns$log2 = ifelse(InvB_cns$log2< -3,-9.5,InvB_cns$log2)
InvB_cnr$log2 = ifelse(InvB_cnr$log2< -1,(InvB_cnr$log2-8)/9,InvB_cnr$log2)
InvB_cns$log2 = ifelse(InvB_cns$log2< -1,(InvB_cns$log2-8)/9,InvB_cns$log2)
InvB_cns = filter(InvB_cns,(end-start)>10000)
index = c(sample(1:round(nrow(InvB_cnr)),round(nrow(InvB_cnr)/20)),(1:nrow(InvB_cnr))[grepl("CDKN2A|CDKN2B|YAP1|RAF1",InvB_cnr[1:nrow(InvB_cnr),]$gene)])
P_InvB_cns = ggplot(InvB_cnr[index,])+
geom_vline(data=chrlen[1:22,],aes(xintercept=aEnd),linetype="dashed",color="darkgrey",size=0.15)+
geom_point(aes((aStart+aEnd)/2,log2),size=0.01,color="gray")+
geom_hline(data=chrlen[1:22,],aes(yintercept= 0),color="gray25",size=0.3)+
geom_segment(aes(x=aStart,xend=aEnd,y=log2,yend=log2),color="purple2",size=0.55,lineend="round",data=InvB_cns)+
scale_y_continuous(limits=c(-2,6.5),breaks=c(-2,0,3,6),labels=c(0,2,16,128))+
ylab("CN")+
scale_x_continuous(limits=c(0,3036290862),expand = c(0.01,0.01),breaks=chrlen$midPoint[c(1:18,20,22,23)],labels=c(1:18,20,22,"X"))+
theme_bw()+
theme(panel.grid = element_blank(),
axis.text.x = element_blank(),
#axis.text.x = element_text(size=unit(5,"pt"),margin=unit(c(-1,0,0,0),"pt")),
#axis.text.x = element_text(size=unit(6,"pt"),margin=unit(c(0,0,0,0),"pt")),
axis.text.y = element_text(size=unit(5,"pt")),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks.x = element_blank(),
plot.margin=unit(c(0,2,0,2),"pt")
)
##################
chrlen$col = c(rep(c("white","black"),12))
myplotdat = filter(chrlen,Chr!="chrY")
myrect3 = ggplot(myplotdat) +
geom_rect(aes(xmin=aStart,xmax=aEnd,ymin=1-0.5,ymax=1+0.5,fill=col))+
scale_fill_manual(values=c("black","gray60"))+
scale_x_continuous(expand = c(0.01,0.01))+
annotate("text",(myplotdat$aStart+myplotdat$aEnd)/2,y=c(rep(1,17),1.25,0.75,1.25,0.75,1.25,1),label=c(1:22,"X"),color="white",size=1.6)+
theme(axis.ticks = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
panel.grid = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
legend.position = "none",
plot.margin=unit(c(-2,1,-2,1),"pt"))
pdf(file="AM2-062_InvA_InvB_cns2.pdf",width=7.2/2.54,height=3.3/2.54)
ggarrange(P_InvA_cns,P_InvB_cns,myrect3,ncol=1,nrow=3,heights=c(1.06,1,0.17),align="v")
dev.off()
library(ggplot2)
library(dplyr)
library(gridExtra)
library(ggpubr)
breakpoints = c(18659478,18893831,20610441,21471422,21905768,24299907,24326299,29126389,29639353,29704611,29724764,29954797,31032372,31092053,31500294,31529089,36886039,40719840,43308638,43716590,45075577,45098983)
InvA_cnr = read.table("./extdata/f4_Case062_InvA.call.cnr",header=T,sep="\t")
InvA_cns = read.table("./extdata/f4_Case062_InvA.call.cns",header=T,sep="\t")
InvA_cnr$col = ifelse(InvA_cnr$chromosome=="chr22" & grepl("EP300",InvA_cnr$gene),"hotpink","gray")
P_InvA = ggplot(filter(InvA_cnr,chromosome=="chr22" & (1:nrow(InvA_cnr))%%6 == 0 ),aes((start+end)/2,log2)) +geom_point(size=0.25,color="gray")+
geom_vline(xintercept=breakpoints,linetype="dashed",color="black",size=0.12)+
geom_segment(aes(x=start,xend=end,y=log2,yend=log2),lineend="butt",color="purple2",size=0.65,data=filter(InvA_cns,chromosome=="chr22"))+
geom_point(data=filter(InvA_cnr,chromosome=="chr22" & col=="hotpink"),aes((start+end)/2,log2),color="hotpink",size=0.3)+
scale_x_continuous(limits=c(15600000,51500000),breaks=c(20000000,30000000,40000000,50000000),labels=c(20,30,40,50),expand=c(0,0))+
scale_y_continuous(breaks=c(-1,1,3),labels=c(1,4,16),limits =c(-2,3))+
theme_bw()+
theme(axis.title.y=element_blank(),
axis.line.x = element_line(size=0.4),
axis.text.y=element_text(size=5),
axis.ticks.x = element_blank(),
axis.text.x=element_blank(),
axis.title.x=element_blank(),
panel.grid = element_blank(),
legend.position = "none",
#panel.grid = element_blank(),
plot.margin=unit(c(0,4,0,3),"pt"),
panel.border = element_blank()
)
MIS_cnr = read.table("extdata/f4_Case062_MIS.call.cnr",header=T,sep="\t")
MIS_cns = read.table("extdata/f4_Case062_MIS.call.cns",header=T,sep="\t")
MIS_cnr$col = ifelse(MIS_cnr$chromosome=="chr22" & grepl("EP300",MIS_cnr$gene),"hotpink","gray")
P_MIS = ggplot(filter(MIS_cnr,chromosome=="chr22"& (1:nrow(MIS_cnr))%%6 == 0),aes((start+end)/2,log2)) +geom_point(size=0.25,color="gray")+
geom_vline(xintercept=breakpoints,linetype="dashed",color="black",size=0.12)+
geom_segment(aes(x=start,xend=end,y=log2,yend=log2),lineend = "butt",color="purple2",size=0.65,data=filter(MIS_cns,chromosome=="chr22"))+
geom_point(data=filter(MIS_cnr,chromosome=="chr22" & col=="hotpink"),aes((start+end)/2,log2),color="hotpink",size=0.3)+
scale_x_continuous(limits=c(15600000,51500000),breaks=c(20000000,30000000,40000000,50000000),labels=c(20,30,40,50),expand=c(0,0))+
ggtitle("Chr 22")+
scale_y_continuous(breaks=c(-1,1,3),labels=c(1,4,16),limits =c(-2,3))+
theme_bw()+
theme(#plot.title =element_text(size=7,margin=margin(1,0,1,0),hjust=0.5),
plot.title=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_text(size=5),
axis.ticks.x = element_blank(),
axis.text.x=element_blank(),
panel.grid = element_blank(),
axis.title.x=element_blank(),
legend.position = "none",
#panel.grid = element_blank(),
plot.margin=unit(c(2,4,0,3),"pt"),
axis.line.x = element_line(size=0.4),
panel.border = element_blank()
)
InvB_cnr = read.table("./extdata/f4_Case062_InvB.call.cnr",header=T,sep="\t")
InvB_cns = read.table("./extdata/f4_Case062_InvB.call.cns",header=T,sep="\t")
InvB_cnr$col = ifelse(InvB_cnr$chromosome=="chr22" & grepl("EP300",InvB_cnr$gene),"hotpink","gray")
P_InvB = ggplot(filter(InvB_cnr,chromosome=="chr22"& (1:nrow(InvB_cnr))%%6 == 0),aes((start+end)/2,log2)) +geom_point(size=0.25,color="gray")+
geom_vline(xintercept=breakpoints,linetype="dashed",color="black",size=0.12)+
geom_segment(aes(x=start,xend=end,y=log2,yend=log2),lineend="butt",color="purple2",size=0.65,data=filter(InvB_cns,chromosome=="chr22"))+
geom_point(data=filter(InvB_cnr,chromosome=="chr22" & col=="hotpink"),aes((start+end)/2,log2),color="hotpink",size=0.3)+
scale_x_continuous(limits=c(15600000,51500000),breaks=c(20000000,30000000,40000000,50000000),labels=c(20,30,40,50),expand=c(0,0))+
#annotate("text",x=55700000,y=6,label="Melanoma2",size=3)+
scale_y_continuous(breaks=c(-1,1,3),labels=c(1,4,16),limits =c(-2,3))+
theme_bw()+
theme(axis.title.y=element_blank(),
axis.text.y=element_text(size=5),
axis.ticks.x = element_blank(),
panel.grid = element_blank(),
axis.text.x=element_blank(),
axis.title.x=element_blank(),
legend.position = "none",
#panel.grid = element_blank(),
plot.margin=unit(c(0,4,0,3),"pt"),
axis.line.x = element_line(size=0.4),
panel.border = element_blank()
)
Met1A_cnr = read.table("./extdata/f4_Case062_Met1A.call.cnr",header=T,sep="\t")
Met1A_cns = read.table("./extdata/f4_Case062_Met1A.call.cns",header=T,sep="\t")
library(ggplot2)
library(dplyr)
library(gridExtra)
library(ggpubr)
breakpoints = c(18659478,18893831,20610441,21471422,21905768,24299907,24326299,29126389,29639353,29704611,29724764,29954797,31032372,31092053,31500294,31529089,36886039,40719840,43308638,43716590,45075577,45098983)
InvA_cnr = read.table("./extdata/f4_Case062_InvA.call.cnr",header=T,sep="\t")
InvA_cns = read.table("./extdata/f4_Case062_InvA.call.cns",header=T,sep="\t")
InvA_cnr$col = ifelse(InvA_cnr$chromosome=="chr22" & grepl("EP300",InvA_cnr$gene),"hotpink","gray")
P_InvA = ggplot(filter(InvA_cnr,chromosome=="chr22" & (1:nrow(InvA_cnr))%%6 == 0 ),aes((start+end)/2,log2)) +geom_point(size=0.25,color="gray")+
geom_vline(xintercept=breakpoints,linetype="dashed",color="black",size=0.12)+
geom_segment(aes(x=start,xend=end,y=log2,yend=log2),lineend="butt",color="purple2",size=0.65,data=filter(InvA_cns,chromosome=="chr22"))+
geom_point(data=filter(InvA_cnr,chromosome=="chr22" & col=="hotpink"),aes((start+end)/2,log2),color="hotpink",size=0.3)+
scale_x_continuous(limits=c(15600000,51500000),breaks=c(20000000,30000000,40000000,50000000),labels=c(20,30,40,50),expand=c(0,0))+
scale_y_continuous(breaks=c(-1,1,3),labels=c(1,4,16),limits =c(-2,3))+
theme_bw()+
theme(axis.title.y=element_blank(),
axis.line.x = element_line(size=0.4),
axis.text.y=element_text(size=5),
axis.ticks.x = element_blank(),
axis.text.x=element_blank(),
axis.title.x=element_blank(),
panel.grid = element_blank(),
legend.position = "none",
#panel.grid = element_blank(),
plot.margin=unit(c(0,4,0,3),"pt"),
panel.border = element_blank()
)
MIS_cnr = read.table("extdata/f4_Case062_MIS.call.cnr",header=T,sep="\t")
MIS_cns = read.table("extdata/f4_Case062_MIS.call.cns",header=T,sep="\t")
MIS_cnr$col = ifelse(MIS_cnr$chromosome=="chr22" & grepl("EP300",MIS_cnr$gene),"hotpink","gray")
P_MIS = ggplot(filter(MIS_cnr,chromosome=="chr22"& (1:nrow(MIS_cnr))%%6 == 0),aes((start+end)/2,log2)) +geom_point(size=0.25,color="gray")+
geom_vline(xintercept=breakpoints,linetype="dashed",color="black",size=0.12)+
geom_segment(aes(x=start,xend=end,y=log2,yend=log2),lineend = "butt",color="purple2",size=0.65,data=filter(MIS_cns,chromosome=="chr22"))+
geom_point(data=filter(MIS_cnr,chromosome=="chr22" & col=="hotpink"),aes((start+end)/2,log2),color="hotpink",size=0.3)+
scale_x_continuous(limits=c(15600000,51500000),breaks=c(20000000,30000000,40000000,50000000),labels=c(20,30,40,50),expand=c(0,0))+
ggtitle("Chr 22")+
scale_y_continuous(breaks=c(-1,1,3),labels=c(1,4,16),limits =c(-2,3))+
theme_bw()+
theme(#plot.title =element_text(size=7,margin=margin(1,0,1,0),hjust=0.5),
plot.title=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_text(size=5),
axis.ticks.x = element_blank(),
axis.text.x=element_blank(),
panel.grid = element_blank(),
axis.title.x=element_blank(),
legend.position = "none",
#panel.grid = element_blank(),
plot.margin=unit(c(2,4,0,3),"pt"),
axis.line.x = element_line(size=0.4),
panel.border = element_blank()
)
InvB_cnr = read.table("./extdata/f4_Case062_InvB.call.cnr",header=T,sep="\t")
InvB_cns = read.table("./extdata/f4_Case062_InvB.call.cns",header=T,sep="\t")
InvB_cnr$col = ifelse(InvB_cnr$chromosome=="chr22" & grepl("EP300",InvB_cnr$gene),"hotpink","gray")
P_InvB = ggplot(filter(InvB_cnr,chromosome=="chr22"& (1:nrow(InvB_cnr))%%6 == 0),aes((start+end)/2,log2)) +geom_point(size=0.25,color="gray")+
geom_vline(xintercept=breakpoints,linetype="dashed",color="black",size=0.12)+
geom_segment(aes(x=start,xend=end,y=log2,yend=log2),lineend="butt",color="purple2",size=0.65,data=filter(InvB_cns,chromosome=="chr22"))+
geom_point(data=filter(InvB_cnr,chromosome=="chr22" & col=="hotpink"),aes((start+end)/2,log2),color="hotpink",size=0.3)+
scale_x_continuous(limits=c(15600000,51500000),breaks=c(20000000,30000000,40000000,50000000),labels=c(20,30,40,50),expand=c(0,0))+
#annotate("text",x=55700000,y=6,label="Melanoma2",size=3)+
scale_y_continuous(breaks=c(-1,1,3),labels=c(1,4,16),limits =c(-2,3))+
theme_bw()+
theme(axis.title.y=element_blank(),
axis.text.y=element_text(size=5),
axis.ticks.x = element_blank(),
panel.grid = element_blank(),
axis.text.x=element_blank(),
axis.title.x=element_blank(),
legend.position = "none",
#panel.grid = element_blank(),
plot.margin=unit(c(0,4,0,3),"pt"),
axis.line.x = element_line(size=0.4),
panel.border = element_blank()
)
Met1A_cnr = read.table("./extdata/f4_Case062_Met1A.call.cnr",header=T,sep="\t")
Met1A_cns = read.table("./extdata/f4_Case062_Met1A.call.cns",header=T,sep="\t")
Met1A_cnr$col = ifelse(Met1A_cnr$chromosome=="chr22" & grepl("EP300",Met1A_cnr$gene),"hotpink","gray")
P_Met1A = ggplot(filter(Met1A_cnr,chromosome=="chr22"& (1:nrow(Met1A_cnr))%%6 == 0),aes((start+end)/2,log2)) +geom_point(size=0.25,color="gray")+
geom_segment(aes(x=start,xend=end,y=log2,yend=log2),lineend="butt",color="purple2",size=0.65,data=filter(Met1A_cns,chromosome=="chr22"))+
geom_vline(xintercept=breakpoints,linetype="dashed",color="black",size=0.12)+
geom_point(data=filter(Met1A_cnr,chromosome=="chr22" & col=="hotpink"),aes((start+end)/2,log2),color="hotpink",size=0.3)+
scale_x_continuous(limits=c(15600000,51500000),breaks=c(20000000,30000000,40000000,50000000),labels=c(20,30,40,50),expand=c(0,0))+
xlab("22q (Mbps)")+
scale_y_continuous(breaks=c(-1,1,3),labels=c(1,4,16),limits =c(-2,3))+
theme_bw()+
theme(axis.title.y=element_blank(),
axis.text.y=element_text(size=5),
panel.grid = element_blank(),
axis.text.x=element_text(size=5),
axis.title.x = element_text(size=7,margin=margin(0,0,0,0)),
legend.position = "none",
#panel.grid = element_blank(),
plot.margin=unit(c(0,4,0,3),"pt"),
axis.line.x = element_line(size=0.4),
panel.border = element_blank()
)
pdf(file="Figure4e.pdf",width=4.6/2.54,height=4/2.54)
ggarrange(P_MIS,P_InvA,P_InvB,P_Met1A,ncol=1,nrow=4,heights=c(1.1,1,1,1.6),align="v")
dev.off()
library(ggplot2)
library(dplyr)
library(gridExtra)
library(ggpubr)
InvA_cnr = read.table("./extdata/f4_Case062_InvA.call.cnr",header=T,sep="\t")
InvA_cnr$log2 = ifelse(InvA_cnr$log2< -1,(InvA_cnr$log2-8)/9,InvA_cnr$log2)
InvA_cns = read.table("./extdata/f4_Case062_InvA.call.cns",header=T,sep="\t")
InvA_cns$log2 = ifelse(InvA_cns$log2< -1,(InvA_cns$log2-8)/9,InvA_cns$log2)
InvA_cnr$col = ifelse(InvA_cnr$chromosome=="chr5" & grepl("TERT",InvA_cnr$gene),"hotpink","gray")
P_InvA = ggplot(filter(InvA_cnr,chromosome=="chr5" & (1:nrow(InvA_cnr))%%1 == 0 ),aes((start/1000000+end/1000000)/2,log2)) +geom_point(size=0.25,color="gray")+
geom_segment(aes(x=start/1000000,xend=end/1000000,y=log2,yend=log2),color="purple2",lineend="round",size=0.65,data=filter(InvA_cns,chromosome=="chr5"))+
geom_point(data=filter(InvA_cnr,chromosome=="chr5" & col=="hotpink"),aes((start/1000000+end/1000000)/2,log2),color="hotpink",size=0.3)+
#geom_hline(yintercept=-1.704,linetype="dashed",color="gray50",size=0.35)+
coord_cartesian(xlim=c(1000000,1300000+250000)/1000000,expand = F,clip = 'on')+
#annotate("text",x=55700000,y=6,label="Melanoma1",size=3)+
scale_y_continuous(breaks=c(-1,0,1),labels=c(1,2,4),limits =c(-1.6,1.6))+
theme_bw()+
theme(axis.title.y=element_blank(),
axis.line.x = element_line(size=0.4),
axis.text.y=element_text(size=5),
axis.ticks.x = element_blank(),
axis.text.x=element_blank(),
axis.title.x=element_blank(),
panel.grid = element_blank(),
legend.position = "none",
#panel.grid = element_blank(),
plot.margin=unit(c(0,4,0,3),"pt"),
panel.border = element_blank()
)
MIS_cnr = read.table("./extdata/f4_Case062_MIS.call.cnr",header=T,sep="\t")
MIS_cnr$log2 = ifelse(MIS_cnr$log2< -1,(MIS_cnr$log2-8)/9,MIS_cnr$log2)
MIS_cns = read.table("./extdata/f4_Case062_MIS.call.cns",header=T,sep="\t")
MIS_cns$log2 = ifelse(MIS_cns$log2< -1,(MIS_cns$log2-8)/9,MIS_cns$log2)
MIS_cnr$col = ifelse(MIS_cnr$chromosome=="chr5" & grepl("TERT",MIS_cnr$gene),"hotpink","gray")
P_MIS = ggplot(filter(MIS_cnr,chromosome=="chr5"& (1:nrow(MIS_cnr))%%1 == 0),aes((start/1000000+end/1000000)/2,log2)) +geom_point(size=0.25,color="gray")+
geom_segment(aes(x=start/1000000,xend=end/1000000,y=log2,yend=log2),lineend = "butt",color="purple2",size=0.65,data=filter(MIS_cns,chromosome=="chr5"))+
geom_point(data=filter(MIS_cnr,chromosome=="chr5" & col=="hotpink"),aes((start/1000000+end/1000000)/2,log2),color="hotpink",size=0.3)+
coord_cartesian(xlim=c(1000000,1300000+250000)/1000000,expand = F,clip = 'on')+
#geom_hline(yintercept=-0.774,linetype="dashed",color="gray50",size=0.35)+
scale_y_continuous(breaks=c(-1,0,1),labels=c(1,2,4),limits =c(-1.6,1.6))+
theme_bw()+
theme(#plot.title =element_text(size=7,margin=margin(1,0,1,0),hjust=0.5),
plot.title=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_text(size=5),
axis.ticks.x = element_blank(),
axis.text.x=element_blank(),
panel.grid = element_blank(),
axis.title.x=element_blank(),
legend.position = "none",
#panel.grid = element_blank(),
plot.margin=unit(c(2,4,0,3),"pt"),
axis.line.x = element_line(size=0.4),
panel.border = element_blank()
)
InvB_cnr = read.table("./extdata/f4_Case062_InvB.call.cnr",header=T,sep="\t")
InvB_cnr$log2 = ifelse(InvB_cnr$log2< -1,(InvB_cnr$log2-8)/9,InvB_cnr$log2)
InvB_cns = read.table("./extdata/f4_Case062_InvB.call.cns",header=T,sep="\t")
InvB_cns$log2 = ifelse(InvB_cns$log2< -1,(InvB_cns$log2-8)/9,InvB_cns$log2)
InvB_cnr$col = ifelse(InvB_cnr$chromosome=="chr5" & grepl("TERT",InvB_cnr$gene),"hotpink","gray")
P_InvB = ggplot(filter(InvB_cnr,chromosome=="chr5"& (1:nrow(InvB_cnr))%%1 == 0),aes((start/1000000+end/1000000)/2,log2)) +geom_point(size=0.25,color="gray")+
geom_segment(aes(x=start/1000000,xend=end/1000000,y=log2,yend=log2),lineend="butt",color="purple2",size=0.65,data=filter(InvB_cns,chromosome=="chr5"))+
geom_point(data=filter(InvB_cnr,chromosome=="chr5" & col=="hotpink"),aes((start/1000000+end/1000000)/2,log2),color="hotpink",size=0.3)+
coord_cartesian(xlim=c(1000000,1300000+250000)/1000000,expand = F,clip = 'on')+
#geom_hline(yintercept=-2.745,linetype="dashed",color="gray50",size=0.35)+
scale_y_continuous(breaks=c(-1,0,1),labels=c(1,2,4),limits =c(-1.6,1.6))+
theme_bw()+
theme(axis.title.y=element_blank(),
axis.text.y=element_text(size=5),
axis.ticks.x = element_blank(),
panel.grid = element_blank(),
axis.text.x=element_blank(),
axis.title.x=element_blank(),
legend.position = "none",
#panel.grid = element_blank(),
plot.margin=unit(c(0,4,0,3),"pt"),
axis.line.x = element_line(size=0.4),
panel.border = element_blank()
)
Met1A_cnr = read.table("./extdata/f4_Case062_Met1A.call.cnr",header=T,sep="\t")
Met1A_cnr$log2 = ifelse(Met1A_cnr$log2< -1,(Met1A_cnr$log2-8)/9,Met1A_cnr$log2)
Met1A_cns = read.table("./extdata/f4_Case062_Met1A.call.cns",header=T,sep="\t")
Met1A_cns$log2 = ifelse(Met1A_cns$log2< -1,(Met1A_cns$log2-8)/9,Met1A_cns$log2)
P_Met1A = ggplot(filter(Met1A_cnr,chromosome=="chr5"& (1:nrow(Met1A_cnr))%%1 == 0),aes((start/1000000+end/1000000)/2,log2)) +geom_point(size=0.25,color="gray")+
geom_segment(aes(x=start/1000000,xend=end/1000000,y=log2,yend=log2),lineend="butt",color="purple2",size=0.65,data=filter(Met1A_cns,chromosome=="chr5"))+
geom_point(data=filter(Met1A_cnr,chromosome=="chr5" & col=="hotpink"),aes((start/1000000+end/1000000)/2,log2),color="hotpink",size=0.3)+
coord_cartesian(xlim=c(1000000,1300000+250000)/1000000,expand = F,clip = 'on')+
scale_x_continuous(breaks=c(1,1.25,1.5),labels=c(1,1.25,1.5))+
scale_y_continuous(breaks=c(-1,0,1),labels=c(1,2,4),limits =c(-1.6,1.6))+
xlab("5p (Mbps)")+
theme_bw()+
theme(axis.title.y=element_blank(),
axis.text.y=element_text(size=5),
panel.grid = element_blank(),
axis.text.x=element_text(size=5),
axis.title.x = element_text(size=7,margin=margin(0,0,0,0)),
legend.position = "none",
#panel.grid = element_blank(),
plot.margin=unit(c(0,4,0,3),"pt"),
axis.line.x = element_line(size=0.4),
panel.border = element_blank()
)
Met1A_cnr = read.table("./extdata/f4_Case062_Met1A.call.cnr",header=T,sep="\t")
Met1A_cnr$log2 = ifelse(Met1A_cnr$log2< -1,(Met1A_cnr$log2-8)/9,Met1A_cnr$log2)
Met1A_cns = read.table("./extdata/f4_Case062_Met1A.call.cns",header=T,sep="\t")
Met1A_cns$log2 = ifelse(Met1A_cns$log2< -1,(Met1A_cns$log2-8)/9,Met1A_cns$log2)
filter(Met1A_cnr,chromosome=="chr5"& (1:nrow(Met1A_cnr))%%1 == 0)
filter(Met1A_cnr,chromosome=="chr5" & col=="hotpink")
filter(InvB_cnr,chromosome=="chr5" & col=="hotpink")
library(ggplot2)
library(dplyr)
library(gridExtra)
library(ggpubr)
InvA_cnr = read.table("./extdata/f4_Case062_InvA.call.cnr",header=T,sep="\t")
InvA_cnr$log2 = ifelse(InvA_cnr$log2< -1,(InvA_cnr$log2-8)/9,InvA_cnr$log2)
InvA_cns = read.table("./extdata/f4_Case062_InvA.call.cns",header=T,sep="\t")
InvA_cns$log2 = ifelse(InvA_cns$log2< -1,(InvA_cns$log2-8)/9,InvA_cns$log2)
InvA_cnr$col = ifelse(InvA_cnr$chromosome=="chr5" & grepl("TERT",InvA_cnr$gene),"hotpink","gray")
P_InvA = ggplot(filter(InvA_cnr,chromosome=="chr5" & (1:nrow(InvA_cnr))%%1 == 0 ),aes((start/1000000+end/1000000)/2,log2)) +geom_point(size=0.25,color="gray")+
geom_segment(aes(x=start/1000000,xend=end/1000000,y=log2,yend=log2),color="purple2",lineend="round",size=0.65,data=filter(InvA_cns,chromosome=="chr5"))+
geom_point(data=filter(InvA_cnr,chromosome=="chr5" & col=="hotpink"),aes((start/1000000+end/1000000)/2,log2),color="hotpink",size=0.3)+
#geom_hline(yintercept=-1.704,linetype="dashed",color="gray50",size=0.35)+
coord_cartesian(xlim=c(1000000,1300000+250000)/1000000,expand = F,clip = 'on')+
#annotate("text",x=55700000,y=6,label="Melanoma1",size=3)+
scale_y_continuous(breaks=c(-1,0,1),labels=c(1,2,4),limits =c(-1.6,1.6))+
theme_bw()+
theme(axis.title.y=element_blank(),
axis.line.x = element_line(size=0.4),
axis.text.y=element_text(size=5),
axis.ticks.x = element_blank(),
axis.text.x=element_blank(),
axis.title.x=element_blank(),
panel.grid = element_blank(),
legend.position = "none",
#panel.grid = element_blank(),
plot.margin=unit(c(0,4,0,3),"pt"),
panel.border = element_blank()
)
MIS_cnr = read.table("./extdata/f4_Case062_MIS.call.cnr",header=T,sep="\t")
MIS_cnr$log2 = ifelse(MIS_cnr$log2< -1,(MIS_cnr$log2-8)/9,MIS_cnr$log2)
MIS_cns = read.table("./extdata/f4_Case062_MIS.call.cns",header=T,sep="\t")
MIS_cns$log2 = ifelse(MIS_cns$log2< -1,(MIS_cns$log2-8)/9,MIS_cns$log2)
MIS_cnr$col = ifelse(MIS_cnr$chromosome=="chr5" & grepl("TERT",MIS_cnr$gene),"hotpink","gray")
P_MIS = ggplot(filter(MIS_cnr,chromosome=="chr5"& (1:nrow(MIS_cnr))%%1 == 0),aes((start/1000000+end/1000000)/2,log2)) +geom_point(size=0.25,color="gray")+
geom_segment(aes(x=start/1000000,xend=end/1000000,y=log2,yend=log2),lineend = "butt",color="purple2",size=0.65,data=filter(MIS_cns,chromosome=="chr5"))+
geom_point(data=filter(MIS_cnr,chromosome=="chr5" & col=="hotpink"),aes((start/1000000+end/1000000)/2,log2),color="hotpink",size=0.3)+
coord_cartesian(xlim=c(1000000,1300000+250000)/1000000,expand = F,clip = 'on')+
#geom_hline(yintercept=-0.774,linetype="dashed",color="gray50",size=0.35)+
scale_y_continuous(breaks=c(-1,0,1),labels=c(1,2,4),limits =c(-1.6,1.6))+
theme_bw()+
theme(#plot.title =element_text(size=7,margin=margin(1,0,1,0),hjust=0.5),
plot.title=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_text(size=5),
axis.ticks.x = element_blank(),
axis.text.x=element_blank(),
panel.grid = element_blank(),
axis.title.x=element_blank(),
legend.position = "none",
#panel.grid = element_blank(),
plot.margin=unit(c(2,4,0,3),"pt"),
axis.line.x = element_line(size=0.4),
panel.border = element_blank()
)
InvB_cnr = read.table("./extdata/f4_Case062_InvB.call.cnr",header=T,sep="\t")
InvB_cnr$log2 = ifelse(InvB_cnr$log2< -1,(InvB_cnr$log2-8)/9,InvB_cnr$log2)
InvB_cns = read.table("./extdata/f4_Case062_InvB.call.cns",header=T,sep="\t")
InvB_cns$log2 = ifelse(InvB_cns$log2< -1,(InvB_cns$log2-8)/9,InvB_cns$log2)
InvB_cnr$col = ifelse(InvB_cnr$chromosome=="chr5" & grepl("TERT",InvB_cnr$gene),"hotpink","gray")
P_InvB = ggplot(filter(InvB_cnr,chromosome=="chr5"& (1:nrow(InvB_cnr))%%1 == 0),aes((start/1000000+end/1000000)/2,log2)) +geom_point(size=0.25,color="gray")+
geom_segment(aes(x=start/1000000,xend=end/1000000,y=log2,yend=log2),lineend="butt",color="purple2",size=0.65,data=filter(InvB_cns,chromosome=="chr5"))+
geom_point(data=filter(InvB_cnr,chromosome=="chr5" & col=="hotpink"),aes((start/1000000+end/1000000)/2,log2),color="hotpink",size=0.3)+
coord_cartesian(xlim=c(1000000,1300000+250000)/1000000,expand = F,clip = 'on')+
#geom_hline(yintercept=-2.745,linetype="dashed",color="gray50",size=0.35)+
scale_y_continuous(breaks=c(-1,0,1),labels=c(1,2,4),limits =c(-1.6,1.6))+
theme_bw()+
theme(axis.title.y=element_blank(),
axis.text.y=element_text(size=5),
axis.ticks.x = element_blank(),
panel.grid = element_blank(),
axis.text.x=element_blank(),
axis.title.x=element_blank(),
legend.position = "none",
#panel.grid = element_blank(),
plot.margin=unit(c(0,4,0,3),"pt"),
axis.line.x = element_line(size=0.4),
panel.border = element_blank()
)
Met1A_cnr = read.table("./extdata/f4_Case062_Met1A.call.cnr",header=T,sep="\t")
Met1A_cnr$log2 = ifelse(Met1A_cnr$log2< -1,(Met1A_cnr$log2-8)/9,Met1A_cnr$log2)
Met1A_cns = read.table("./extdata/f4_Case062_Met1A.call.cns",header=T,sep="\t")
Met1A_cns$log2 = ifelse(Met1A_cns$log2< -1,(Met1A_cns$log2-8)/9,Met1A_cns$log2)
Met1A_cnr$col = ifelse(Met1A_cnr$chromosome=="chr5" & grepl("TERT",Met1A_cnr$gene),"hotpink","gray")
P_Met1A = ggplot(filter(Met1A_cnr,chromosome=="chr5"& (1:nrow(Met1A_cnr))%%1 == 0),aes((start/1000000+end/1000000)/2,log2)) +geom_point(size=0.25,color="gray")+
geom_segment(aes(x=start/1000000,xend=end/1000000,y=log2,yend=log2),lineend="butt",color="purple2",size=0.65,data=filter(Met1A_cns,chromosome=="chr5"))+
geom_point(data=filter(Met1A_cnr,chromosome=="chr5" & col=="hotpink"),aes((start/1000000+end/1000000)/2,log2),color="hotpink",size=0.3)+
coord_cartesian(xlim=c(1000000,1300000+250000)/1000000,expand = F,clip = 'on')+
scale_x_continuous(breaks=c(1,1.25,1.5),labels=c(1,1.25,1.5))+
scale_y_continuous(breaks=c(-1,0,1),labels=c(1,2,4),limits =c(-1.6,1.6))+
xlab("5p (Mbps)")+
theme_bw()+
theme(axis.title.y=element_blank(),
axis.text.y=element_text(size=5),
panel.grid = element_blank(),
axis.text.x=element_text(size=5),
axis.title.x = element_text(size=7,margin=margin(0,0,0,0)),
legend.position = "none",
#panel.grid = element_blank(),
plot.margin=unit(c(0,4,0,3),"pt"),
axis.line.x = element_line(size=0.4),
panel.border = element_blank()
)
pdf(file="Figure4f.pdf",width=2.5/2.54,height=4/2.54)
ggarrange(P_MIS,P_InvA,P_InvB,P_Met1A,ncol=1,nrow=4,heights=c(1.1,1,1,1.6),align="v")
dev.off()
